rewrittin in c for embedded devices
]
